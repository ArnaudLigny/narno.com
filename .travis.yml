language: php
php:
  - 7
sudo: false
branches:
  only:
    - master
# Download PHPoole
install:
  - curl -SOL https://phpoole.org/phpoole.phar
# Display PHPoole version
before_script:
  - php phpoole.phar -v
# Run PHPoole build
script:
  - php phpoole.phar build
# Deploy to GitHub Pages
deploy:
  provider: pages
  skip_cleanup: true
  github_token: $GH_TOKEN
  local_dir: _site
  on:
    branch: master
# Flush Cloudflare cache
after_deploy:
  - "curl -X DELETE \"https://api.cloudflare.com/client/v4/zones/${Cloudflare_zone}/purge_cache\" \
    -H \"X-Auth-Email: arnaud@ligny.org\" \
    -H \"X-Auth-Key: ${Cloudflare_API}\" \
    -H \"Content-Type: application/json\" \
    --data '{\"purge_everything\":true}'"
